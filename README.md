Cloudflare Workers/Pages ç”¨é‡ç›‘æ§

ä¸€ä¸ªåŸºäº Cloudflare Workers å¼€å‘çš„ç”¨é‡ç›‘æ§å·¥å…·ï¼Œå¯ä»¥å®æ—¶ç›‘æ§å¤šä¸ª Cloudflare è´¦æˆ·çš„ Workers å’Œ Pages æœåŠ¡è¯·æ±‚ä½¿ç”¨æƒ…å†µã€‚

[![Deploy with Vercel](https://img.shields.io/badge/status-active-success)
[![Deploy with Vercel](https://img.shields.io/badge/license-MIT-blue)
[![Deploy with Vercel](https://re.zxz.us.kg/raw/s/IMG_0229.png)

âœ¨ åŠŸèƒ½ç‰¹ç‚¹

Â· ğŸ¯ å¤šè´¦æˆ·æ”¯æŒ - åŒæ—¶ç›‘æ§å¤šä¸ª Cloudflare è´¦æˆ·
Â· ğŸ“Š å®æ—¶æ•°æ® - æ˜¾ç¤º Workers å’Œ Pages çš„è¯·æ±‚é‡å’Œä½¿ç”¨æƒ…å†µ
Â· ğŸ¨ ç¾è§‚ç•Œé¢ - ç°ä»£åŒ–ã€å“åº”å¼çš„ä»ªè¡¨æ¿ç•Œé¢
Â· ğŸŒ™ ä¸»é¢˜åˆ‡æ¢ - æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜
Â· âš¡ å¿«é€Ÿå“åº” - ä½¿ç”¨å¹¶å‘æŸ¥è¯¢ä¼˜åŒ–æ€§èƒ½
Â· ğŸ”„ è‡ªåŠ¨åˆ·æ–° - æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°æ•°æ®
Â· ğŸ“± ç§»åŠ¨å‹å¥½ - å®Œç¾é€‚é…å„ç§å±å¹•å°ºå¯¸

ğŸš€ å¿«é€Ÿå¼€å§‹

å‰ææ¡ä»¶

Â· Cloudflare è´¦æˆ·
Â· Workers æƒé™
Â· éœ€è¦ç›‘æ§çš„è´¦æˆ·çš„ API å¯†é’¥

éƒ¨ç½²æ­¥éª¤

1. å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
   ```bash
   git clone <repository-url>
   cd workers-usage-monitor
   ```
2. é…ç½®ç¯å¢ƒå˜é‡
   åœ¨ Cloudflare Workers æ§åˆ¶å°ä¸­è®¾ç½® EDGE ç¯å¢ƒå˜é‡ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
   ```json
   [
     {
       "name": "è´¦æˆ·1",
       "email": "your-email1@example.com",
       "key": "your-api-key1",
       "accountId": "your-account-id1",
       "total": 100000
     },
     {
       "name": "è´¦æˆ·2", 
       "email": "your-email2@example.com",
       "key": "your-api-key2",
       "accountId": "your-account-id2",
       "total": 100000
     }
   å¤šå¸å·ä»¥æ­¤ç±»æ¨â€¦â€¦
   ]
   ```
3. éƒ¨ç½² Worker
   å°† worker.js æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ° Cloudflare Workers ç¼–è¾‘å™¨ä¸­ï¼Œæˆ–ä½¿ç”¨ Wrangler CLI éƒ¨ç½²ï¼š
   ```bash
   wrangler deploy
   ```
4. è®¿é—®ç›‘æ§é¢æ¿
   æ‰“å¼€ Worker çš„ URL å³å¯è®¿é—®ç›‘æ§é¢æ¿ã€‚

âš™ï¸ é…ç½®è¯´æ˜

ç¯å¢ƒå˜é‡

å˜é‡å ç±»å‹ å¿…éœ€ è¯´æ˜
EDGE å¯†é’¥ Array âœ… è´¦æˆ·é…ç½®æ•°ç»„

è´¦æˆ·é…ç½®å­—æ®µ

å­—æ®µ ç±»å‹ å¿…éœ€ è¯´æ˜
name String âŒ è´¦æˆ·æ˜¾ç¤ºåç§°
email String âœ… Cloudflare è´¦æˆ·é‚®ç®±
key String âœ… API å¯†é’¥
accountId String âœ… è´¦æˆ· ID
total Number âŒ æ€»è¯·æ±‚é¢åº¦ï¼ˆé»˜è®¤ 100,000ï¼‰

API å¯†é’¥æƒé™

ç¡®ä¿ API å¯†é’¥å…·æœ‰ä»¥ä¸‹æƒé™ï¼š

Â· Account Analytics: Read
Â· Account Settings: Read

ğŸ¯ ä½¿ç”¨æ–¹æ³•

åŸºæœ¬æ“ä½œ

1. æŸ¥çœ‹æ€»è§ˆï¼šé¦–é¡µæ˜¾ç¤ºæ‰€æœ‰è´¦æˆ·çš„æ€»è§ˆç»Ÿè®¡
2. åˆ‡æ¢è´¦æˆ·ï¼šç‚¹å‡»"æŸ¥çœ‹è´¦å·"ä¸‹æ‹‰èœå•é€‰æ‹©ç‰¹å®šè´¦æˆ·
3. åˆ·æ–°æ•°æ®ï¼šç‚¹å‡»"åˆ·æ–°æ•°æ®"æŒ‰é’®æ‰‹åŠ¨æ›´æ–°
4. ä¸»é¢˜åˆ‡æ¢ï¼šç‚¹å‡»ä¸»é¢˜åˆ‡æ¢æŒ‰é’®åˆ‡æ¢äº®è‰²/æš—è‰²æ¨¡å¼

API æ¥å£

Â· GET / - è¿”å›ç›‘æ§é¢æ¿ HTML é¡µé¢
Â· GET /?all=true - è¿”å›æ‰€æœ‰è´¦æˆ·çš„ JSON æ•°æ®
Â· GET /?accountIndex=N - è¿”å›æŒ‡å®šè´¦æˆ·çš„ JSON æ•°æ®
Â· GET /?optimized=true - è¿”å›ä¼˜åŒ–åçš„ç¼“å­˜æ•°æ®

ğŸ“Š æ•°æ®è¯´æ˜

ç›‘æ§æŒ‡æ ‡

Â· Pages è¯·æ±‚æ•°ï¼šCloudflare Pages å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°
Â· Workers è¯·æ±‚æ•°ï¼šCloudflare Workers çš„è°ƒç”¨æ¬¡æ•°
Â· å‰©ä½™é¢åº¦ï¼šæ€»é…é¢å‡å»å·²ä½¿ç”¨é‡
Â· ä½¿ç”¨ç™¾åˆ†æ¯”ï¼šå‰©ä½™é¢åº¦å æ€»é…é¢çš„ç™¾åˆ†æ¯”

çŠ¶æ€æŒ‡ç¤º

Â· ğŸŸ¢ å……è¶³ï¼šå‰©ä½™é¢åº¦ â‰¥ 70%
Â· ğŸŸ¡ è­¦å‘Šï¼šå‰©ä½™é¢åº¦ 30% - 70%
Â· ğŸ”´ ä¸è¶³ï¼šå‰©ä½™é¢åº¦ < 30%

ğŸ”§ æŠ€æœ¯ç»†èŠ‚

æ¶æ„è®¾è®¡

```
ç”¨æˆ·è¯·æ±‚ â†’ Cloudflare Worker â†’ Cloudflare GraphQL API â†’ æ•°æ®å¤„ç† â†’ å“åº”è¿”å›
```

æ€§èƒ½ä¼˜åŒ–

Â· å¹¶å‘æŸ¥è¯¢ï¼šåŒæ—¶æŸ¥è¯¢å¤šä¸ªè´¦æˆ·ï¼Œå¤§å¹…å‡å°‘ç­‰å¾…æ—¶é—´
Â· æ™ºèƒ½ç¼“å­˜ï¼š2åˆ†é’Ÿç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ API è°ƒç”¨
Â· é‡è¯•æœºåˆ¶ï¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¯·æ±‚
Â· é”™è¯¯éš”ç¦»ï¼šå•ä¸ªè´¦æˆ·å¤±è´¥ä¸å½±å“å…¶ä»–è´¦æˆ·

æŠ€æœ¯æ ˆ

Â· è¿è¡Œæ—¶ï¼šCloudflare Workers
Â· å‰ç«¯ï¼šåŸç”Ÿ HTML/CSS/JavaScript
Â· APIï¼šCloudflare GraphQL API
Â· éƒ¨ç½²ï¼šCloudflare è¾¹ç¼˜ç½‘ç»œ

ğŸ› ï¸ å¼€å‘æŒ‡å—

æœ¬åœ°å¼€å‘

1. å®‰è£… Wrangler CLIï¼š
   ```bash
   npm install -g wrangler
   ```
2. ç™»å½• Cloudflareï¼š
   ```bash
   wrangler login
   ```
3. æœ¬åœ°æµ‹è¯•ï¼š
   ```bash
   wrangler dev
   ```

è‡ªå®šä¹‰é…ç½®

ä¿®æ”¹ä»£ç ä¸­çš„å¸¸é‡æ¥è°ƒæ•´è¡Œä¸ºï¼š

```javascript
// è°ƒæ•´å¹¶å‘é™åˆ¶
const CONCURRENT_LIMIT = 5;

// è°ƒæ•´ç¼“å­˜æ—¶é—´
const ttl = 2 * 60 * 1000; // 2åˆ†é’Ÿ

// è°ƒæ•´é‡è¯•ç­–ç•¥
const maxRetries = 2;
const retryDelay = 1000;
```

ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (git checkout -b feature/AmazingFeature)
3. æäº¤æ›´æ”¹ (git commit -m 'Add some AmazingFeature')
4. æ¨é€åˆ°åˆ†æ”¯ (git push origin feature/AmazingFeature)
5. å¼€å¯ Pull Request

ğŸ“ æ›´æ–°æ—¥å¿—

v1.0.0

Â· âœ… å¤šè´¦æˆ·ç›‘æ§æ”¯æŒ
Â· âœ… å®æ—¶æ•°æ®å±•ç¤º
Â· âœ… ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
Â· âœ… å¹¶å‘æŸ¥è¯¢ä¼˜åŒ–
Â· âœ… è‡ªåŠ¨åˆ·æ–°æœºåˆ¶

âš ï¸ æ³¨æ„äº‹é¡¹

1. API é™åˆ¶ï¼šCloudflare API æœ‰é€Ÿç‡é™åˆ¶ï¼Œè¯·åˆç†é…ç½®åˆ·æ–°é¢‘ç‡
2. æƒé™å®‰å…¨ï¼šå¦¥å–„ä¿ç®¡ API å¯†é’¥ï¼Œä½¿ç”¨æœ€å°æƒé™åŸåˆ™
3. æ•°æ®å»¶è¿Ÿï¼šç›‘æ§æ•°æ®å¯èƒ½æœ‰å‡ åˆ†é’Ÿçš„å»¶è¿Ÿ
4. é…é¢è®¡ç®—ï¼šç¡®ä¿é…ç½®çš„æ€»é…é¢ä¸å®é™…è´¦æˆ·é…é¢ä¸€è‡´

ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æº - æŸ¥çœ‹ LICENSE æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

ğŸ™ è‡´è°¢

Â· Cloudflare Workers
Â· Cloudflare GraphQL API
Â· æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·

---

æœ‰é—®é¢˜ï¼Ÿ è¯·æäº¤ Issue æˆ–è”ç³»ç»´æŠ¤è€…ã€‚

è§‰å¾—æœ‰ç”¨ï¼Ÿ è¯·ç»™ä¸ª â­ï¸ æ”¯æŒä¸€ä¸‹ï¼
